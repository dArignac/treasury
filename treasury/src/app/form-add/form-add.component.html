<div class="container-fluid">
  <div class="row">
    <div class="col">
      <h1>Add movie(s):</h1>
      <div class="md-form">
        <input #search mdbActive type="text" id="form1" class="form-control" [formControl]="movieControl" (focus)="search.value=''">
        <label for="form1" class="">Enter a movie title...</label>
      </div>
    </div>
  </div>
  <div class="row movie-results">
    <ng-container *ngIf="results$ | async as movies">
      <ng-container *ngIf="movies.length > 0; else empty">
        <div class="col-12 col-lg-6 mb-2" *ngFor="let movie of movies">
          <div class="row">

            <div class="col-2 hidden-xs">
              <ng-container *ngIf="movie.getPosterImage('w92') as poster; else noPoster">
                <img [src]="poster" alt="{{movie.title}}"/>
              </ng-container>
              <ng-template #noPoster>
                <div class="no-poster text-center img-thumbnail pt-3">No image available</div>
              </ng-template>
            </div>

            <div class="col-12 col-sm-10">

              <div class="row">
                <div class="col-12">
                  <strong>{{movie.title}}</strong>
                </div>
              </div>

              <div class="row">
                <div class="col-3 hidden-xs label">Release date:</div>
                <div class="col-9">
                  <span *ngIf="movie.release_date">{{ movie.release_date }}</span>
                  <span *ngIf="!movie.release_date">Unknown</span>
                </div>
              </div>

              <div class="row">
                <div class="col-3 hidden-xs label">Starring:</div>
                <div class="col-9">
                  <span *ngIf="movie.credits_actresses.length > 0">{{ movie.credits_actresses }}</span>
                  <span *ngIf="movie.credits_actresses.length == 0">Unknown</span>
                </div>
              </div>

              <div class="row">
                <div class="col-3 hidden-xs label">Directed by:</div>
                <div class="col-9">
                  <span *ngIf="movie.credits_directors.length > 0">{{ movie.credits_directors }}</span>
                  <span *ngIf="movie.credits_directors.length == 0">Unknown</span>
                </div>
              </div>

              <div class="row">
                <div class="col-3 hidden-xs"></div>
                <div class="col-12 col-sm-9">
                  <button
                    type="button"
                    [ngClass]="{'animated pulse infinite btn-secondary': addingItemsStatus.hasOwnProperty(movie.id) && !addingItemsStatus[movie.id], 'btn-primary': !addingItemsStatus.hasOwnProperty(movie.id)}"
                    class="btn btn-sm float-left"
                    (click)="addMovie(movie)"
                    *ngIf="!addingItemsStatus.hasOwnProperty(movie.id) || addingItemsStatus.hasOwnProperty(movie.id) && !addingItemsStatus[movie.id]"
                  >
                    <span *ngIf="!addingItemsStatus.hasOwnProperty(movie.id)">Add</span>
                    <span *ngIf="addingItemsStatus.hasOwnProperty(movie.id) && !addingItemsStatus[movie.id]">Adding...</span>
                  </button>
                  <button
                    type="button"
                    class="btn btn-sm btn-dark-green float-left"
                    disabled
                    *ngIf="addingItemsStatus.hasOwnProperty(movie.id) && addingItemsStatus[movie.id]"
                  >
                    <i class="fa fa-check-circle fa-lg" aria-hidden="true"></i>
                  </button>
                </div>
              </div>

            </div>

            <ng-template #errorModal></ng-template>

          </div>
        </div>
      </ng-container>
      <ng-template #empty>
        <div class="col">
          No results found.
        </div>
      </ng-template>
    </ng-container>
  </div>
</div>
<router-outlet></router-outlet>
